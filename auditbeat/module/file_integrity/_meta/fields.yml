- key: file_integrity
  title: File Integrity
  description: These are the fields generated by the file_integrity module.
  fields:
    - name: hash
      type: group
      description: >
        Hashes of the file. The keys are algorithm names and the values are
        the hex encoded digest values.

      fields:
        - name: blake2b_256
          type: keyword
          description: BLAKE2b-256 hash of the file.

        - name: blake2b_384
          type: keyword
          description: BLAKE2b-384 hash of the file.

        - name: blake2b_512
          type: keyword
          description: BLAKE2b-512 hash of the file.

        - name: md5
          overwrite: true
          type: keyword
          description: MD5 hash of the file.

        - name: sha1
          overwrite: true
          type: keyword
          description: SHA1 hash of the file.

        - name: sha224
          type: keyword
          description: SHA224 hash of the file.

        - name: sha256
          overwrite: true
          type: keyword
          description: SHA256 hash of the file.

        - name: sha384
          type: keyword
          description: SHA384 hash of the file.

        - name: sha3_224
          type: keyword
          description: SHA3_224 hash of the file.

        - name: sha3_256
          type: keyword
          description: SHA3_256 hash of the file.

        - name: sha3_384
          type: keyword
          description: SHA3_384 hash of the file.

        - name: sha3_512
          type: keyword
          description: SHA3_512 hash of the file.

        - name: sha512
          overwrite: true
          type: keyword
          description: SHA512 hash of the file.

        - name: sha512_224
          type: keyword
          description: SHA512/224 hash of the file.

        - name: sha512_256
          type: keyword
          description: SHA512/256 hash of the file.

        - name: xxh64
          type: keyword
          description: XX64 hash of the file.

    # These are extensions to the file field set
    - name: file
      title: File
      description: Extensions to the ECS File field set
      type: group
      fields:
        # ELF fields
        - name: elf
          title: ELF file information
          description: These fields contain Linux Executable Linkable Format (ELF) metadata.
          type: group
          fields:
            - name: header.class
              description: >
                Header class of the ELF file.
              type: keyword

            - name: header.data
              description: >
                Data type of the ELF header.
              type: keyword

            - name: header.machine
              description: >
                Machine type of the ELF header.
              type: keyword

            - name: header.os_abi
              description: >
                Application Binary Interface (ABI) of the Linux OS.
              type: keyword

            - name: header.type
              description: >
                Header type of the ELF file.
              type: keyword

            - name: header.version
              description: >
                Version of the ELF header.
              type: keyword

            - name: header.abi_version
              type: keyword
              description: >
                Version of the ELF Application Binary Interface (ABI).

            - name: header.entrypoint
              format: string
              type: long
              description: >
                Header entrypoint of the ELF file.

            - name: sections
              description: >
                Section information of the ELF file.
              type: nested
              fields:
                - name: flags
                  description: >
                    ELF Section List flags.
                  type: keyword

                - name: name
                  description: >
                    ELF Section List name.
                  type: keyword

                - name: physical_offset
                  description: >
                    ELF Section List offset.
                  type: keyword

                - name: type
                  description: >
                    ELF Section List type.
                  type: keyword

                - name: physical_size
                  description: >
                    ELF Section List physical size.
                  format: bytes
                  type: long

                - name: virtual_address
                  description: >
                    ELF Section List virtual address.
                  format: string
                  type: long

                - name: virtual_size
                  description: >
                    ELF Section List virtual size.
                  format: string
                  type: long

                - name: entropy
                  description: >
                    Shannon entropy calculation from the section.
                  format: number
                  type: double

                - name: chi2
                  description: >
                    Chi-square probability distribution of the section.
                  format: number
                  type: double

            - name: exports
              description: >
                List of exported element names and types.
              type: flattened

            - name: imports
              description: >
                List of imported element names and types.
              type: flattened

            - name: shared_libraries
              description: >
                List of shared libraries used by this ELF object
              type: keyword

            - name: telfhash
              short: telfhash hash for ELF files
              description: >
                telfhash is symbol hash for ELF files, just like imphash is imports hash for PE files. Learn more at https://github.com/trendmicro/telfhash.
              type: keyword

            - name: segments
              description: >
                ELF object segment list.
              type: nested
              fields:
                - name: type
                  description: ELF object segment type.
                  type: keyword

                - name: sections
                  description: ELF object segment sections.
                  type: keyword

            - name: debug
              type: nested
              description: Debug information, if present
              fields:
                - name: offset
                  type: keyword
                  description: Debug offset information.
                  example: 1296336

                - name: size
                  type: long
                  format: bytes
                  description: Size of the debug information.
                  example: 816

                - name: type
                  type: keyword
                  description: Information type generated by the debug options.
                  example: IMAGE_DEBUG_TYPE_POGO

                - name: timestamp
                  type: date
                  description: Timestamp of the debug information.
                  example: "2020-11-05T17:25:47.000Z"

            - name: packers
              description: >
                List of packers and tools used.
              type: keyword
              example: '["ASPack v2.12", ".NET executable"]'
              normalize:
                - array

        # PE fields
        - name: pe
          title: PE file information.
          description: PE ECS field extensions
          type: group
          fields:
            - name: debug
              type: nested
              description: Debug information, if present
              fields:
                - name: offset
                  type: keyword
                  description: Debug offset information.
                  example: 1296336

                - name: size
                  type: long
                  format: bytes
                  description: Size of the debug information.
                  example: 816

                - name: type
                  type: keyword
                  description: Information type generated by the debug options.
                  example: IMAGE_DEBUG_TYPE_POGO

                - name: timestamp
                  type: date
                  description: Timestamp of the debug information.
                  example: "2020-11-05T17:25:47.000Z"

            - name: imports
              type: flattened
              description: List of all imported functions
              example: '{ "library" : "mscoree.dll", "name" : "GetFileVersionInfoSizeA" }'

            - name: sections
              description: >
                Data about sections of compiled binary PE
              type: nested
              fields:
                - name: chi2
                  description: Chi-square probability distribution.
                  type: long
                  example: 3027194

                - name: virtual_address
                  description: Virtual address available to the file.
                  type: long
                  format: bytes
                  example: 8192

                - name: entropy
                  description: Measurement of entropy randomness in the file.
                  type: float
                  example: 6.24

                - name: flags
                  description: Section flags of the file.
                  type: keyword
                  example: rx

                - name: name
                  description: Section names of the file.
                  type: keyword
                  example: .text, .data

                - name: raw_size
                  description: Size of the section or the dize of the initialized data on disk.
                  type: long
                  format: bytes
                  example: 198144

            - name: resources
              type: nested
              description: >
                If the PE contains resources, some info about them
              fields:
                - name: chi2
                  description: Chi-square probability distribution.
                  type: long
                  example: -1

                - name: filetype
                  description: File type of the resources section.
                  type: keyword
                  example: Data

                - name: entropy
                  description: Measurement of entropy randomness in the resources section.
                  type: long
                  example: 0, 1

                - name: sha256
                  description: SHA256 hash of resources section.
                  type: keyword
                  example: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

                - name: language
                  description: Language identification.
                  type: keyword
                  example: "CHINESE SIMPLIFIED"

                - name: type
                  type: keyword
                  short: List of resource types.
                  description: >
                    Digest of resource types.
                  example: '["RT_VERSION", "RT_MANIFEST"]'
                  normalize:
                    - array

            - name: exports
              type: keyword
              description: >
                List of symbols exported by PE
              example: '["DllInstall", "DllRegisterServer", "DllUnregisterServer"]'
              normalize:
                - array

            - name: icons
              type: flattened
              description: >
                If the PE contains icons, some info about them

            - name: authentihash
              description: >
                Authentihash of the PE file.
              type: keyword
              example: ac9555d914bbb112ecc5f15bb9887ca8371f493ab0941344e976bb8410c8aa78

            - name: compile_timestamp
              description: >
                Compile timestamp of the PE file.
              type: date
              example: "2020-11-05T17:25:47.000Z"

            - name: compiler.name
              type: keyword
              description: >
                Name of the compiler
              example: Clang

            - name: compiler.version
              type: keyword
              description: >
                Version of the compiler.
              example: 11.0.0

            - name: rich_header.hash.md5
              type: keyword
              description: >
                MD5 hash of the header for the PE file.
              example: 5aa1aa0f2b4be70397a1e9e2b87627cd

            - name: entrypoint
              description: >
                Relative byte offset to the base of the PE file.
              type: keyword
              example: 25856

            - name: packers
              description: >
                List of packers and tools used.
              type: keyword
              example: '["ASPack v2.12", ".NET executable"]'
              normalize:
                - array

        # MachO
        - name: macho
          title: Mach-O file information.
          type: group
          description: These fields contain macOS Mach Object (Mach-O) metadata.
          fields:
            - name: architectures
              description: Object files contained inside this file by architecture
              type: nested
              fields:
                - name: debug
                  type: nested
                  description: Debug information, if present
                  fields:
                    - name: offset
                      type: keyword
                      description: Debug offset information.
                      example: 1296336

                    - name: size
                      type: long
                      format: bytes
                      description: Size of the debug information.
                      example: 816

                    - name: type
                      type: keyword
                      description: Information type generated by the debug options.
                      example: IMAGE_DEBUG_TYPE_POGO

                    - name: timestamp
                      type: date
                      description: Timestamp of the debug information.
                      example: "2020-11-05T17:25:47.000Z"

                - name: cpu
                  description: CPU architecture target for the file.
                  type: keyword
                  example: 64-bit

                - name: byte_order
                  description: Byte order for the file.
                  type: keyword
                  example: little-endian

                - name: type
                  description: Mach-O file type.
                  type: keyword

                - name: header.commands
                  description: Header load commands
                  type: nested
                  fields:
                    - name: number
                      description: Number of load commands for the Mach-O header.
                      type: long
                      example: 23

                    - name: size
                      description: Size of load commands of the Mach-O header.
                      type: long
                      format: bytes
                      example: 3888

                    - name: type
                      description: Type of the load commands for the Mach-O header.
                      type: keyword
                      example: LC_SYMTAB, 0x2c

                - name: header.magic
                  description: Magic field of the Mach-O header.
                  type: keyword
                  example: 0xfeedfacf

                - name: header.flags
                  description: Flags set in the Mach-O header.
                  type: keyword
                  example: TWOLEVEL, 0x4000000

                - name: segments
                  description: Segment information for the file.
                  type: nested
                  fields:
                    - name: vmaddr
                      description: Memory address of this segment.
                      type: keyword
                      example: 0x0

                    - name: name
                      description: Name of this segment.
                      type: keyword
                      example: __TEXT, __DATA, __IMPORT

                    - name: vmsize
                      description: Memory size of this segment.
                      type: keyword
                      example: 0x4c000

                    - name: fileoff
                      description: File offset of this segment.
                      type: keyword
                      example: 0x0

                    - name: filesize
                      description: Amount of memory to map from the file.
                      type: keyword
                      example: 0x4c000

                    - name: sections
                      description: Section information for the segment of the file.
                      type: nested
                      fields:
                        - name: name
                          description: Name of this section.
                          type: keyword

                        - name: type
                          description: Type of this section.
                          type: keyword

                        - name: offset
                          description: Offset of this section.
                          type: long

                        - name: size
                          description: Size of this section.
                          type: long

                        - name: entropy
                          description: Entropy of this section.
                          type: double

                        - name: chi2
                          description: Chi-square of this section.
                          type: double

                        - name: flags
                          description: Flags of this section.
                          type: keyword

                    - name: flags
                      description: Segment flags.
                      type: keyword

                - name: libraries
                  description: Imported libraries.
                  type: keyword

                - name: imports
                  description: Imported symbols.
                  type: keyword

                - name: exports
                  description: Exported symbols.
                  type: keyword

                - name: packers
                  description: Packers.
                  type: keyword

                - name: symhash
                  description: Symbol hash.
                  type: keyword

                - name: cdhash
                  description: Code Digest (CD) SHA256 hash of the first 20-bytes of the file.
                  type: keyword

        # LNK
        - name: lnk
          title: LNK file information.
          type: group
          description: These fields contain windows LNK metadata.
          fields:
            - name: name
              description: LNK name
              type: keyword

            - name: relative_path
              description: LNK relative path
              type: keyword

            - name: working_directory
              description: LNK working directory
              type: keyword

            - name: command_line
              description: LNK command line
              type: keyword

            - name: icon_location
              description: LNK icon location
              type: keyword

            - name: extra
              description: Extra fields in the LNK, type specific
              type: flattened

            - name: header.guid
              description: LNK guid
              type: keyword

            - name: header.link_flags
              description: LNK link flags
              type: keyword

            - name: header.file_flags
              description: LNK file flags
              type: keyword

            - name: header.creation_time
              description: LNK creation time
              type: date

            - name: header.accessed_time
              description: LNK accessed time
              type: date

            - name: header.modified_time
              description: LNK modified time
              type: date

            - name: header.file_size
              description: LNK file size
              type: long

            - name: header.icon_index
              description: LNK icon index
              type: long

            - name: header.window_style
              description: LNK window style
              type: keyword

            - name: header.hot_key
              description: LNK hot key
              type: keyword

            - name: targets
              description: LNK targets
              type: nested
              fields:
                - name: size
                  description: LNK target size
                  type: integer

                - name: type_id
                  description: LNK target type id
                  type: integer

                - name: sha256
                  description: LNK target sha256
                  type: keyword

            - name: location.flags
              description: LNK location flags
              type: keyword

            - name: location.common_path_suffix
              description: LNK common path suffix
              type: keyword

            - name: location.local_base_path
              description: LNK local base path
              type: keyword

            - name: location.volume.drive_type
              description: LNK volume drive type
              type: keyword

            - name: location.volume.drive_serial_number
              description: LNK volume drive serial number
              type: keyword

            - name: location.volume.volume_label
              description: LNK volume label
              type: keyword

            - name: location.network_share.flags
              description: LNK network share flags
              type: keyword

            - name: location.network_share.provider_type
              description: LNK network share provider type
              type: keyword

            - name: location.network_share.name
              description: LNK network share name
              type: keyword

            - name: location.network_share.device_name
              description: LNK network share device name
              type: keyword
